worker_processes auto;
pid /tmp/nginx.pid;

events {
  worker_connections 1024;
  use epoll;
  multi_accept on;
}

http {
  # this is necessary for us to be able to disable request buffering in all cases

  include       /etc/nginx/mime.types;
  default_type  application/octet-stream;
  keepalive_timeout  65;

  log_format timed_combined '$status - $body_bytes_sent - "$request"'
    '"$http_referer"'
    '$request_time $upstream_response_time $pipe';

  access_log /dev/stdout timed_combined;

  server {
    listen 3000 default_server;
    server_name _;

    # Default server block for handling requests from unspecified domains
    return 403;
  }

  server {
    listen 3000;
    server_name meals-front.livelybay-8a7bca45.eastus.azurecontainerapps.io;
    server_tokens off;

    root /usr/share/nginx/html;

    # disable any limits to avoid HTTP 413 for large image uploads
    client_max_body_size 0;

    # required to avoid HTTP 411:
    chunked_transfer_encoding on;
  }
}
